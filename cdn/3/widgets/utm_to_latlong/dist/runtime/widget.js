System.register(["jimu-core","jimu-ui","esri/geometry/Point","esri/geometry/projection","esri/geometry/SpatialReference"],(function(e,t){var o={},n={},r={},i={},s={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(s,"__esModule",{value:!0}),{setters:[function(e){o.React=e.React,o.jsx=e.jsx},function(e){n.Button=e.Button},function(e){Object.keys(e).forEach((function(t){r[t]=e[t]}))},function(e){Object.keys(e).forEach((function(t){i[t]=e[t]}))},function(e){Object.keys(e).forEach((function(t){s[t]=e[t]}))}],execute:function(){e((()=>{var e={205:e=>{"use strict";if(void 0===s){var t=new Error("Cannot find module 'esri/geometry/SpatialReference'");throw t.code="MODULE_NOT_FOUND",t}e.exports=s},244:e=>{"use strict";e.exports=o},321:e=>{"use strict";e.exports=n},333:e=>{"use strict";if(void 0===i){var t=new Error("Cannot find module 'esri/geometry/projection'");throw t.code="MODULE_NOT_FOUND",t}e.exports=i},422:e=>{"use strict";e.exports=r}},t={};function l(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,l),r.exports}l.d=(e,t)=>{for(var o in t)l.o(t,o)&&!l.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="";var a={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(a),l.d(a,{__set_webpack_public_path__:()=>c,default:()=>s});var e=l(244),t=l(321),o=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function l(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,l)}a((n=n.apply(e,t||[])).next())}))};const n=26918,r=4326;function i(e){const t=String(null!=e?e:"");return t.includes(",")||t.includes('"')||t.includes("\n")?`"${t.replace(/"/g,'""')}"`:t}function s(s){const[a,c]=e.React.useState(null),[d,u]=e.React.useState(""),[f,v]=e.React.useState(null),[p,m]=e.React.useState(""),[g,y]=e.React.useState(""),[h,x]=e.React.useState(""),[j,b]=e.React.useState("idle"),w=e.React.useRef(null),S=e.React.useCallback((e=>{var t;const o=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!o)return;const n=new FileReader;n.onload=()=>{var e,t;try{const r=function(e){const t=e.split(/\r?\n/).filter((e=>e.trim()));if(0===t.length)return{headers:[],rows:[]};const o=e=>{const t=[];let o="",n=!1;for(let r=0;r<e.length;r++){const i=e[r];'"'===i?n=!n:","!==i||n?o+=i:(t.push(o.trim().replace(/^"|"$/g,"").replace(/""/g,'"')),o="")}return t.push(o.trim().replace(/^"|"$/g,"").replace(/""/g,'"')),t};return{headers:o(t[0]),rows:t.slice(1).map(o)}}(n.result||"");let i="",s="";r.headers.forEach((e=>{const t=e.toLowerCase();i||!t.includes("x")&&!t.includes("east")||(i=e),s||!t.includes("y")&&!t.includes("north")||(s=e)})),c(o),u(o.name),v(r),m(null!==(e=i||r.headers[0])&&void 0!==e?e:""),y(null!==(t=s||r.headers[1])&&void 0!==t?t:""),x(`Loaded ${r.rows.length} rows`),b("success")}catch(e){c(null),u(""),v(null),m(""),y(""),x(`Error: ${e.message}`),b("error")}},n.readAsText(o),e.target.value=""}),[]),R=e.React.useCallback((()=>o(this,void 0,void 0,(function*(){var e,t,o,s,a,c;if(!f||!p||!g)return x("Select a CSV and both X and Y fields."),void b("error");const u=f.headers.indexOf(p),v=f.headers.indexOf(g);if(u<0||v<0)return x("Selected fields not found in CSV."),void b("error");x("Converting..."),b("busy");try{const p=(yield Promise.resolve().then(l.bind(l,422))).default,m=(yield Promise.resolve().then(l.bind(l,205))).default,g=yield Promise.resolve().then(l.bind(l,333));yield g.load();const y=[];let h=0,j=0;for(let i=0;i<f.rows.length;i++){const l=f.rows[i],d=null!==(t=null===(e=l[u])||void 0===e?void 0:e.trim())&&void 0!==t?t:"",x=null!==(s=null===(o=l[v])||void 0===o?void 0:o.trim())&&void 0!==s?s:"",b=parseFloat(d),w=parseFloat(x);if(Number.isNaN(b)||Number.isNaN(w)){j++,y.push([...l,"",""]);continue}const S=new p({x:b,y:w,spatialReference:new m({wkid:n})}),R=g.project(S,new m({wkid:r})),O=null!==(a=R.latitude)&&void 0!==a?a:R.y,C=null!==(c=R.longitude)&&void 0!==c?c:R.x;y.push([...l,O,C]),h++}const w=[[...f.headers,"Latitude","Longitude"].map(i).join(",")];y.forEach((e=>w.push(e.map(i).join(","))));const S=new Blob([w.join("\n")],{type:"text/csv;charset=utf-8"}),R=URL.createObjectURL(S),O=document.createElement("a");O.href=R,O.download=d.replace(/\.csv$/i,"_latlong.csv")||"converted.csv",O.click(),URL.revokeObjectURL(R);let C=`Converted ${h} coordinates. Download started.`;j>0&&(C+=` Skipped ${j} row(s) with invalid numbers.`),x(C),b("success")}catch(e){x(`Conversion failed: ${e.message}`),b("error")}}))),[f,p,g,d]),O="error"===j?"#c00":"success"===j?"#0a0":"busy"===j?"#06c":"#666";return(0,e.jsx)("div",{className:"utm-to-latlong-widget jimu-widget",style:{padding:12,height:"100%",overflow:"auto"}},(0,e.jsx)("div",{style:{fontWeight:"bold",fontSize:16,marginBottom:4}},"UTM to Lat/Long Converter"),(0,e.jsx)("div",{style:{fontSize:12,color:"#666",marginBottom:12}},"NAD83 UTM Zone 18N to WGS84 Lat/Long"),(0,e.jsx)("div",{style:{marginBottom:12}},(0,e.jsx)("div",{style:{fontSize:12,marginBottom:4}},"CSV File"),(0,e.jsx)("input",{ref:w,type:"file",accept:".csv",onChange:S,style:{display:"none"}}),(0,e.jsx)("div",{style:{fontSize:12,color:d?"#000":"#888",marginBottom:6}},d?`Selected: ${d}${f?` (${f.rows.length} rows)`:""}`:"No file selected"),(0,e.jsx)(t.Button,{type:"primary",onClick:()=>{var e;return null===(e=w.current)||void 0===e?void 0:e.click()}},"Browse CSV File")),f&&f.headers.length>0&&(0,e.jsx)("div",{style:{marginBottom:12}},(0,e.jsx)("div",{style:{fontSize:12,marginBottom:6}},"Select Fields"),(0,e.jsx)("div",{style:{marginBottom:6}},(0,e.jsx)("label",{style:{display:"block",fontSize:11,marginBottom:2}},"X (Easting)"),(0,e.jsx)("select",{value:p,onChange:e=>m(e.target.value),style:{width:"100%",padding:"6px",fontSize:12,border:"1px solid #ccc",borderRadius:4}},f.headers.map((t=>(0,e.jsx)("option",{key:t,value:t},t))))),(0,e.jsx)("div",{style:{marginBottom:6}},(0,e.jsx)("label",{style:{display:"block",fontSize:11,marginBottom:2}},"Y (Northing)"),(0,e.jsx)("select",{value:g,onChange:e=>y(e.target.value),style:{width:"100%",padding:"6px",fontSize:12,border:"1px solid #ccc",borderRadius:4}},f.headers.map((t=>(0,e.jsx)("option",{key:t,value:t},t)))))),(0,e.jsx)(t.Button,{type:"primary",onClick:R,disabled:!f||!p||!g,style:{marginBottom:8}},"Convert to Lat/Long"),h&&(0,e.jsx)("div",{style:{fontSize:12,color:O,marginTop:8}},h))}function c(e){l.p=e}})(),a})())}}}));